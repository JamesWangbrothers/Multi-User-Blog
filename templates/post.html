{% extends "base.html" %}

{% block content %}
	<div>
		<h3 class="post-title">{{post.subject}}</h3>
	    <small>by {{post.user.name}} on {{post.created.strftime("%b %d, %Y")}}</small>
		<p>{{post.content | safe}}</p>
	</div>

	{% if user %}
		<form method = "POST">
			<input class= "btn btn-default" type="submit" name="edit" value="&#x270e; edit">
	    	<input class= "btn btn-default" type="submit" name="delete" value="&#10060; delete">
	    	<input class= "btn btn-default" type="submit" name="like" value="{{likes}} &#128077;">
			<input class= "btn btn-default" type="submit" name="dislike" value="{{dislikes}} &#128078;">
		</form>
	{% else %}
		<input class= "btn btn-default" type="submit" name="like" value="{{likes}} &#128077;">
		<input class= "btn btn-default" type="submit" name="dislike" value="{{dislikes}} &#128078;">
	{% endif %}

	<div class="error">{{error}}</div>
	<hr>

	{% if user %}
		<form method="POST">
			<label>
				Leave a comment<br>
				<textarea class="form-control" name="comment_text" style="width:765px; height:120px;">{{comment_text | safe}}</textarea>
			</label>
			<div class="error">{{comment_error}}</div>
			<input class= "btn btn-default" type="submit" name="add_comment" value="Post &#x270d;">
		</form>
	{% endif %}
	<br>

	<h3>Comments</h3>
		{% for comment in comments %}
			<strong>{{comment.user.name}}</strong>
			<small class = "text-muted">posted on {{comment.created.strftime("%a, %b %d %Y %H:%M:%S")}}</small>
			{% if comment.user.name == user.name %}
				<a href="/blog/{{post.key().id()}}/editcomment/{{comment.key().id()}}">edit</a>
				<a href="/blog/{{post.key().id()}}/deletecomment/{{comment.key().id()}}">delete</a>
				<br>
			{% endif %}
			<p>{{comment.text}}</p>
		{% endfor %}
	{% if not user %}
		<br><br>
		<p class="text-muted">If you want leave a comment, please login or sign up first</p>
	{% endif %}
{% endblock %}